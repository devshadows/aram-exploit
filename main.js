const axios = require('axios');
const LCUConnector = require('lcu-connector');
const connector = new LCUConnector();
const https = require('https');
const agent = new https.Agent({
    rejectUnauthorized: false,
});
const readline = require('readline');
const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout
});
const log = console.log;
var api;


connector.on('connect', async(credentials) => {
	console.log('\nConectado com o client. \n');
	perguntar();

	api = axios.create({
		baseURL:`https://127.0.0.1:${credentials.port}`,
		headers: {
			'content-type': 'application/json',
			'Authorization': `Basic ${Buffer.from(`${credentials.username}:${credentials.password}`)
            .toString("base64")}`,
		},
		httpsAgent: agent
	});
}).start();

function boostar(){
	api.post('/lol-champ-select/v1/team-boost/purchase/')
.then((response)=> {
	if (response.status === 200) {
		console.log('\nBoostado com sucesso!')
	}
	else {
		throw new Error();
	}
}).catch(error =>{
	console.log("\nDeu o seguinte erro:", error.response.status, "\n")
});
};

var perguntar = function () {
	rl.question('Você quer boostar? (sim/nao)\n(TENHA CERTEZA QUE VOCÊ TEM MENOS DE 95 RP NA CONTA, CASO CONTRARIO ELES SERÃO UTILIZADOS)\n', function (answer){
		if (answer === 'sim'){
			boostar();
			var delay=3000; //1 seconds
setTimeout(function(){
        perguntar();
        //your code to be executed after 1 seconds
},delay);
		}
		else {
			log('\nVocê recusou! \n');
			perguntar();
		}
	});
};
